# Authentication

<a name="authlocal"></a>

## Authenticate local user

Local users are considered to be in the msui.yaml file, or in the database table `users`.

**URL** : `/xhr/login`

**Method** : `POST`

**Authentication required** : `NO`

**Body parameters**

- **username**: string (Valid username or email address)
- **password**: string (Password in plain-text)

**Example**

```
POST /xhr/login
{
  "username": "admin",
  "password": "badpassword"
}
```

### On success

Response Code : `200`

```
{
  "session": {
    "maxAge": number
    "totp": boolean
  }
}
```

### On failure

Response Code :

- `400 Bad Request`
- `401 Unauthorized`
- `429 Too Many Requests`
- `500 Internal Server Error`

---

<a name="authldap"></a>

## Authenticate LDAP user

LDAP sources can be added in the msui.yaml file.

**URL** : `/xhr/login/ldap`

**Method** : `POST`

**Authentication required** : `NO`

**Body parameters**

- **username**: string (Valid username or email address)
- **password**: string (Password in plain-text)

**Example**

```
POST /xhr/login/ldap
{
  "username": "admin",
  "password": "badpassword"
}
```

### On success

Response Code : `200`

```
{
  "session": {
    "maxAge": number
    "totp": boolean
  }
}
```

### On failure

Response Code :

- `400 Bad Request`
- `401 Unauthorized`
- `429 Too Many Requests`
- `500 Internal Server Error`

---

<a name="authtotp"></a>

## Authenticate TOTP

Use when the `totp` parameter is set to `true` in the response from `/xhr/login` or /`xhr/login/ldap`.

**URL** : `/xhr/totp`

**Method** : `POST`

**Authentication required** : `YES`

**Body parameters**

- **token**: string (A token that should be generated by Google Authenticator)

**Example**

```
POST /xhr/totp
{
  "token": "123456"
}
```

### On success

Response Code : `204`

### On failure

Response Code :

- `401 Unauthorized`
- `500 Internal Server Error`

---

<a name="authremote"></a>

## Remote Authentication

Can only be used when the authentication strategy is set to `remote` in msui.yaml file. When enabled, the backend will automically create a session based on the username that is specified by an incoming HTTP header (identifier), which should only be used in proxy mode, and the specific header should always be set by a remote identify provider, e.g. SAML with the Apache's mod_shib.

**URL** : `/xhr/login/remote`

**Method** : `POST`

**Authentication required** : `NO`

### On success

Response Code : `200`

```
{
  "session": {
    "maxAge": number
    "totp": boolean
  }
}
```

### On failure

Response Code :

- `400 Bad Request`
- `401 Unauthorized`
- `429 Too Many Requests`
- `500 Internal Server Error`

---

<a name="resetpassword"></a>

## Reset user password (from session or provided token)

**URL** : `/xhr/password/reset`

**Method** : `POST`

**Authentication required** : `YES`

**Body parameters**

**User session**
- **password**: string
- **new_password**: string

**Token**
- **token**: string
- **username**: username
- **new_password**: string

**Example**

```
POST /xhr/password/reset
{
  "password": "badpassword",
  "new_password": "betterpassword"
}
```

### On success

Response Code : `204`

### On failure

Response Code :

- `401 Unauthorized`
- `500 Internal Server Error`